<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Responsive Navbar</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.7.0/flowbite.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/lucide@latest/dist/umd/lucide.min.js"></script>
  <style>
   .signature-container {
  border: 2px dotted #CCCCCC;
  
}

    
  </style>
</head>
<body class=" bg-[#EBE9F2] pb-20">
<nav class="bg-[#31264B] border-gray-200">
    <div class="max-w-screen-xl flex items-center justify-between mx-auto px-6 py-4">
    
      <div class="flex items-center space-x-4">
        <button id="hamburger" class="text-gray-300 focus:outline-none">
        
          <svg id="hamburger-icon" class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
          </svg>
        
          <svg id="close-icon" class="w-6 h-6 hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
    
        
        <a href="dashboard.html" class="flex items-center">
          <img src="images/weswitchu.png" class="h-8" alt="WeSwitchU.ie Logo">
        </a>
      </div>
    
      <div class="flex items-center space-x-3 md:space-x-6">
        <div class="relative">
          <button id="user-menu-button" class="flex text-sm bg-gray-800 rounded-full focus:ring-4 focus:ring-gray-300">
            <img class="w-8 h-8 rounded-full" src="https://flowbite.com/docs/images/people/profile-picture-3.jpg" alt="User Photo">
          </button>
          <div id="user-dropdown" class="hidden absolute right-0 mt-2 bg-white text-gray-700 rounded-lg shadow-md w-48 z-50">
            <div class="px-4 py-3">
              <p class="text-sm font-medium text-gray-900">John Doe</p>
              <p class="text-sm text-gray-500 truncate">email@example.com</p>
            </div>
            <ul class="py-2">
              <li>
                <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Personal Settings</a>
              </li>
              <li>
                <a href="#" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">Sign out</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </nav>
   <!-- Sidebar -->
   <aside id="default-sidebar"
    class="fixed top-[63px] left-0 z-40 w-64 h-[calc(100%-63px)] transition-transform -translate-x-full bg-[#31264B] overflow-y-auto"
    aria-label="Sidebar">
    <div class="h-full px-3 py-4">
        <ul class="space-y-2 font-medium text-white">
        
        <!-- Dashboard Dropdown -->
        <li>
            <a href="dashboard.html"  class="flex items-center p-2 text-gray-900 rounded-lg hover:bg-gray-100 dark:text-white dark:hover:bg-gray-700 group">
              <svg class="w-5 h-5 text-gray-500 transition duration-75 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 22 21">
                <path d="M16.975 11H10V4.025a1 1 0 0 0-1.066-.998 8.5 8.5 0 1 0 9.039 9.039.999.999 0 0 0-1-1.066h.002Z"/>
                <path d="M12.5 0c-.157 0-.311.01-.565.027A1 1 0 0 0 11 1.02V10h8.975a1 1 0 0 0 1-.935c.013-.188.028-.374.028-.565A8.51 8.51 0 0 0 12.5 0Z"/>
              </svg>
              <span class="ms-3">Dashboard</span>
            </a>
          </li>
  
        <!-- Products Dropdown -->
        <li>
          <button class="flex items-center w-full p-2 rounded-lg hover:bg-gray-700 group" onclick="toggleDropdown('products-dropdown')">
            <img src="images/business_15931237.png" class="w-5 h-5 mr-2" alt="Bills" style="filter: invert(1);"> <!-- Bills Icon -->
            <span class="ms-3 flex-1 text-left">Bills</span>
            <svg class="w-4 h-4 transition-transform group-hover:text-white" id="settings-arrow" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
              <path d="M5 8l5 5 5-5H5z" />
            </svg>
          </button>
          <ul id="products-dropdown" class="pl-6 mt-1 hidden space-y-1">
            <li><a href="javascript:void(0)" onclick="loadContent('billlist.html')" class="block p-2 rounded-lg hover:bg-gray-600">Bill List</a></li>
            <li><a href="#" class="block p-2 rounded-lg hover:bg-gray-600">Upload Bills</a></li>
            <!-- <li><a href="#" class="block p-2 rounded-lg hover:bg-gray-600">Add Electricity Bills</a></li> -->
          </ul>
        </li>
        <li>
          <button class="flex items-center w-full p-2 rounded-lg hover:bg-gray-700 group" onclick="toggleDropdown('meter-dropdown')">
            <img src="images/bar-graph.png" class="w-5 h-5 mr-2" alt="Meter Readings" style="filter: invert(1);"> <!-- Meter Icon -->
            <span class="ms-3 flex-1 text-left">Meter Readings</span>
            <svg class="w-4 h-4 transition-transform group-hover:text-white" id="products-arrow" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
              <path d="M5 8l5 5 5-5H5z" />
            </svg>
          </button>
          <ul id="meter-dropdown" class="pl-6 mt-1 hidden space-y-1">
            <li><a href="Bill_List.html"  class="block p-2 rounded-lg hover:bg-gray-600">Meter Reading List</a></li>
            <li><a href="#" class="block p-2 rounded-lg hover:bg-gray-600">Add Gas Readings</a></li>
            <li><a href="#" class="block p-2 rounded-lg hover:bg-gray-600">Add Electricity Readings</a></li>
          </ul>
        </li>
        <li>
          <button class="flex items-center w-full p-2 rounded-lg hover:bg-gray-700 group" onclick="toggleDropdown('budget-dropdown')">
            <img src="images/money-bag.png" class="w-5 h-5 mr-2" style="filter: invert(1);" alt="Budget Plans">
            <span class="ms-3 flex-1 text-left">Fees</span>
            <svg class="w-4 h-4 transition-transform group-hover:text-white" id="products-arrow" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
              <path d="M5 8l5 5 5-5H5z" />
            </svg>
          </button>
          <ul id="budget-dropdown" class="pl-6 mt-1 hidden space-y-1">
            <li><a href="#" class="block p-2 rounded-lg hover:bg-gray-600">Invoices</a></li>
            <li><a href="#" class="block p-2 rounded-lg hover:bg-gray-600">Payments</a></li>
          </ul>
        </li>
        <li>
          <button class="flex items-center w-full p-2 rounded-lg hover:bg-gray-700 group" onclick="toggleDropdown('documents-dropdown')">
            <img src="images/folder.png" class="w-5 h-5 mr-2" style="filter: invert(1);" alt="Documents">
            <span class="ms-3 flex-1 text-left">Documents</span>
            <svg class="w-4 h-4 transition-transform group-hover:text-white" id="products-arrow" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
              <path d="M5 8l5 5 5-5H5z" />
            </svg>
          </button>
          <ul id="documents-dropdown" class="pl-6 mt-1 hidden space-y-1">
            <li><a href="#" class="block p-2 rounded-lg hover:bg-gray-600">Document List</a></li>
            <li><a href="#" class="block p-2 rounded-lg hover:bg-gray-600">Add HDF File</a></li>
          </ul>
        </li>
        <li>
          <button class="flex items-center w-full p-2 rounded-lg hover:bg-gray-700 group" onclick="toggleDropdown('settings-dropdown')">
            <img src="images/settings_3524636.png" class="w-5 h-5 mr-2" style="filter: invert(1);" alt="Documents">
            <span class="ms-3 flex-1 text-left">Settings</span>
            <svg class="w-4 h-4 transition-transform group-hover:text-white" id="products-arrow" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
              <path d="M5 8l5 5 5-5H5z" />
            </svg>
          </button>
          <ul id="settings-dropdown" class="pl-6 mt-1 hidden space-y-1">
            <li><a href="editproperties.html" class="block p-2 rounded-lg hover:bg-gray-600">Property Settings</a></li>
            <li><a href="personalsettings.html" class="block p-2 rounded-lg hover:bg-gray-600">Personal Settings</a></li>
            <li><a href="paymentmethodadd.html" class="block p-2 rounded-lg hover:bg-gray-600">Payment Settings</a></li>
            <li><a href="#" class="block p-2 rounded-lg hover:bg-gray-600">Contact</a></li>
            <li><a href="#" class="block p-2 rounded-lg hover:bg-gray-600">Add Location</a></li>
          </ul>
        </li>
  
      </ul>
    </div>
  </aside>
  <div class="flex flex-wrap items-center justify-between pr-8 py-6">
    <!-- Left Section: Welcome Message and Breadcrumb -->
    <div class="space-y-2 herosec ml-20">
      <h1 class="text-2xl font-bold text-gray-900">Add Payment Method</h1>
      <div class="flex items-center text-sm text-gray-500 space-x-2">
        <a href="dashboard.html" class="flex items-center space-x-1">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
            <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" />
          </svg>
        </a>
        <span>‚Ä∫</span>
        <a href="#" class="text-purple-600 hover:underline">Add Payment Method</a>
      </div>
    </div>
  
    <div class="flex flex-wrap items-center space-x-4 mt-4">
      <!-- Gas Emergency Button -->
      <button
      class="gasemer flex items-center space-x-2 bg-red-50 text-red-600 px-4 py-2 rounded-md shadow-md hover:bg-red-100 hover:shadow-lg transition-all duration-300 emergency-btn sm:px-3 sm:py-1 sm:text-sm"> 
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-triangle-alert"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"/><path d="M12 9v4"/><path d="M12 17h.01"/></svg>       
       <span class="text-xs sm:text-sm">Gas Emergency</span>
      </button>
  
      <!-- Electricity Emergency Button -->
      <button
      class="elecemer flex items-center space-x-2 bg-yellow-50 text-yellow-600 px-4 py-2 rounded-md shadow-md hover:bg-yellow-100 hover:shadow-lg transition-all duration-300 emergency-btn sm:px-3 sm:py-1 sm:text-sm"      >
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-triangle-alert"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"/><path d="M12 9v4"/><path d="M12 17h.01"/></svg>
        <span class="text-xs sm:text-sm">Electricity Emergency</span>
      </button>
    </div>
  </div>
  <div class="max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-6 relative top-[40px]">

    <!-- Direct Debit Mandates Section -->
    <div class="md:col-span-2 bg-white p-6 rounded-lg shadow-md">
        <h2 class="text-2xl font-semibold text-gray-900 mb-4">üí≥ Direct Debit Mandates</h2>
        <p class="text-gray-600 mb-6">Manage your direct debit payment methods for automatic payments.</p>

        <div id="payment-list">
            <!-- Existing Payments -->
            <div class="border rounded-lg p-4 mb-4 flex flex-col md:flex-row items-start md:items-center justify-between shadow-sm gap-4 md:gap-0">
                
                <!-- Bank Icon & Details -->
                <div class="flex items-start md:items-center w-full md:w-auto">
                    <div class="w-12 h-12 bg-gray-200 flex items-center justify-center rounded-full mr-3 shrink-0">
                        <span class="text-gray-600 text-xl">üè¶</span>
                    </div>
                    <div class="w-full">
                        <h3 class="font-semibold text-gray-900 text-lg">Deutsche Bank</h3>
                        <p class="text-gray-600 text-sm break-words">IBAN: <span class="font-mono">DE89 3704 0044 0532 0130 00</span></p>
                        <p class="text-gray-600 text-sm">Reference: <span class="font-mono">REF-DB-2023-001</span></p>
                    </div>
                </div>
        
                <!-- Status & Actions -->
                <div class="text-right md:text-left flex flex-col md:items-end w-full md:w-auto">
                    <span class="bg-green-100 text-green-600 text-xs font-semibold px-3 py-1 rounded-full status inline-block w-fit">Active</span>
                    <p class="text-gray-500 text-xs mt-1">Added on 2023-05-15</p>
                    
                    <!-- Cancel Button -->
                    <button class="cancel-btn mt-2 bg-gray-200 text-gray-700 px-3 py-2 rounded-md hover:bg-gray-300 transition-all duration-200 text-sm">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
        <!-- Left-Aligned Small Button -->
        <div class="flex">
            <button id="add-payment-btn" class="bg-blue-600 text-white px-3 py-2 rounded-md hover:bg-blue-700 text-sm">
                ‚ûï Add Payment Method
            </button>
        </div>
    </div>

    <!-- Payment Security Section -->
    <div class="bg-white p-6 rounded-lg shadow-md">
        <h2 class="text-2xl font-semibold text-gray-900 mb-4">üîí Payment Security</h2>
        <ul class="space-y-3 text-gray-600">
            <li class="flex items-center space-x-3">
                <span class="bg-green-100 text-green-600 px-2 py-1 rounded-full text-xs font-semibold">‚úî</span>
                <p>Secure Processing with bank-level encryption.</p>
            </li>
            <li class="flex items-center space-x-3">
                <span class="bg-green-100 text-green-600 px-2 py-1 rounded-full text-xs font-semibold">‚úî</span>
                <p>Direct Debit protected by your bank's guarantee scheme.</p>
            </li>
            <li class="flex items-center space-x-3">
                <span class="bg-green-100 text-green-600 px-2 py-1 rounded-full text-xs font-semibold">‚úî</span>
                <p>Full transparency - you‚Äôll be notified before payment is taken.</p>
            </li>
        </ul>
    </div>

    <!-- About Direct Debit Payments -->
    <div class="md:col-span-2 bg-white p-6 rounded-lg shadow-md">
        <!-- Header Section -->
        <div class="flex items-center space-x-2 mb-4">
            <span class="text-blue-600 text-2xl">üõ°</span>
            <h2 class="text-2xl font-semibold text-gray-900">About Direct Debit Payments</h2>
        </div>
        
        <!-- Description -->
        <p class="text-gray-600 mb-6">
            Direct Debit is an automated payment method where you authorize us to collect payments directly from your bank account.
        </p>
    
        <!-- Benefits Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <!-- Benefit 1 -->
            <div class="flex items-start bg-gray-50 p-4 rounded-lg">
                <span class="text-green-600 text-xl mr-3">‚úÖ</span>
                <div>
                    <h3 class="font-semibold text-gray-900">Automatic payments</h3>
                    <p class="text-gray-600 text-sm">Never miss a due date</p>
                </div>
            </div>
    
            <!-- Benefit 2 -->
            <div class="flex items-start bg-gray-50 p-4 rounded-lg">
                <span class="text-green-600 text-xl mr-3">üõ°</span>
                <div>
                    <h3 class="font-semibold text-gray-900">Secure transactions</h3>
                    <p class="text-gray-600 text-sm">Protected by your bank</p>
                </div>
            </div>
    
            <!-- Benefit 3 -->
            <div class="flex items-start bg-gray-50 p-4 rounded-lg">
                <span class="text-green-600 text-xl mr-3">‚úÖ</span>
                <div>
                    <h3 class="font-semibold text-gray-900">Easy management</h3>
                    <p class="text-gray-600 text-sm">Set up and cancel anytime</p>
                </div>
            </div>
    
            <!-- Benefit 4 -->
            <div class="flex items-start bg-gray-50 p-4 rounded-lg">
                <span class="text-green-600 text-xl mr-3">‚úÖ</span>
                <div>
                    <h3 class="font-semibold text-gray-900">No expiration</h3>
                    <p class="text-gray-600 text-sm">Unlike credit cards</p>
                </div>
            </div>
        </div>
    
        <!-- Alert Box -->
        <div class="mt-6 bg-blue-100 text-blue-600 p-4 rounded-lg text-sm flex items-start">
            <span class="text-blue-600 text-xl mr-3">üõ°</span>
            <p>
                You can cancel a Direct Debit mandate at any time. Once canceled, no further payments will be collected using that mandate.
            </p>
        </div>
    </div>
    

<!-- Add Payment Modal -->
<div id="payment-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center">
  <div class="bg-white p-6 rounded-lg shadow-lg max-w-md w-full">
      <h2 class="text-xl font-semibold mb-4">Add Payment Method</h2>

      <!-- Bank Name -->
      <label class="block text-gray-700">Bank Name</label>
      <input type="text" id="bank-name" class="w-full border rounded-md p-2 mb-1" placeholder="Enter Bank Name">
      <p id="bank-name-error" class="text-red-600 text-sm mb-4 hidden">Bank Name is required.</p>

      <!-- IBAN -->
      <label class="block text-gray-700">IBAN</label>
      <input type="text" id="iban" class="w-full border rounded-md p-2 mb-1" placeholder="Enter IBAN" maxlength="22">
      <p id="iban-error" class="text-red-600 text-sm mb-4 hidden">Invalid IBAN. Must be 22 characters long.</p>

      <!-- Authorization Checkbox -->
      <div class="flex items-center mb-1">
          <input type="checkbox" id="authorize" class="mr-2">
          <p class="text-gray-700">I authorize the company to debit my account.</p>
      </div>
      <p id="authorize-error" class="text-red-600 text-sm mb-4 hidden">You must authorize the debit.</p>

     
      <h1 class="text-xl font-semibold text-gray-800 pb-6">Draw Your Signature</h1>
            <div class="signature-container">
        
        <canvas id="signature-pad"></canvas>
        
        <p id="saved-signature"></p>
    </div>
		
    <div class="buttons pt-6 pb-6">
      <button id="clear-btn" class="px-4 py-2 bg-blue-900 text-white rounded-lg shadow hover:bg-red-600 transition">
        Clear
    </button>
    
  </div>
		
      <!-- Security Info -->
      <div class="bg-blue-100 text-blue-600 p-3 rounded-md text-sm mb-4">
          <p>üîí Your bank details are secure and will only be used for processing payments you authorize.</p>
      </div>

      <!-- Buttons -->
      <div class="flex justify-between">
          <button id="cancel-btn" class="bg-gray-200 px-4 py-2 rounded-md">Cancel</button>
          <button id="save-payment" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700">Save</button>
      </div>
  </div>
</div>

  
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const hamburger = document.getElementById("hamburger");
    const sidebar = document.getElementById("default-sidebar");
    const hamburgerIcon = document.getElementById("hamburger-icon");
    const closeIcon = document.getElementById("close-icon");
    const body = document.body;
    const userMenuButton = document.getElementById("user-menu-button");
    const userDropdown = document.getElementById("user-dropdown");

    function openSidebar() {
        sidebar.classList.remove("-translate-x-full");
        body.classList.add("overflow-hidden"); // Prevent scrolling
    }

    function closeSidebar() {
        sidebar.classList.add("-translate-x-full");
        body.classList.remove("overflow-hidden"); // Enable scrolling
    }

    // Toggle Sidebar
    if (hamburger && sidebar) {
        hamburger.addEventListener("click", function () {
            if (sidebar.classList.contains("-translate-x-full")) {
                openSidebar();
            } else {
                closeSidebar();
            }
        });
    }

    // Close sidebar when clicking outside
    document.addEventListener("click", function (event) {
        if (!sidebar.contains(event.target) && !hamburger.contains(event.target)) {
            closeSidebar();
        }
    });

    // Toggle User Dropdown
    if (userMenuButton && userDropdown) {
        userMenuButton.addEventListener("click", function (event) {
            event.stopPropagation(); // Prevent closing when clicking inside dropdown
            userDropdown.classList.toggle("hidden");
        });

        // Close dropdown when clicking outside
        document.addEventListener("click", function (event) {
            if (!userMenuButton.contains(event.target) && !userDropdown.contains(event.target)) {
                userDropdown.classList.add("hidden");
            }
        });
    }
});

    </script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
          const ibanInput = document.getElementById("iban");
          const ibanError = document.getElementById("iban-error");
          const saveButton = document.getElementById("save-payment");
      
          // Ensure IBAN is always uppercase and only contains allowed characters
          ibanInput.addEventListener("input", function () {
              this.value = this.value.toUpperCase().replace(/[^A-Z0-9]/g, "").slice(0, 22);
              ibanError.classList.add("hidden"); // Hide error when user types
          });
      
          // Validate IBAN format
          function validateIBAN(iban) {
              // Ensure correct length (22 characters)
              if (iban.length !== 22) return false;
      
              // Match Irish IBAN structure: IEkkAAAA123456789012345
              const regex = /^IE\d{2}[A-Z]{4}\d{14}$/;
              return regex.test(iban);
          }
      
          // Handle form submission
          saveButton.addEventListener("click", function (event) {
              event.preventDefault(); // Prevent form submission
      
              const ibanValue = ibanInput.value.trim();
              if (!validateIBAN(ibanValue)) {
                  ibanError.textContent = "Invalid IBAN. Must follow format: IEkkAAAA123456789012345";
                  ibanError.classList.remove("hidden");
              } else {
                  ibanError.classList.add("hidden");
                  alert("IBAN is valid and saved successfully!"); // Placeholder action
                  // Proceed with form submission logic...
              }
          });
      });
      </script>
      
      <script>
        document.addEventListener("DOMContentLoaded", function () {
            const modal = document.getElementById("payment-modal");
            const saveButton = document.getElementById("save-payment");
            const cancelButton = document.getElementById("cancel-btn");
            const addPaymentButton = document.getElementById("add-payment-btn");
            const bankNameInput = document.getElementById("bank-name");
            const ibanInput = document.getElementById("iban");
            const authorizeCheckbox = document.getElementById("authorize");
            const signaturePad = document.getElementById("signature-pad");
            const clearSignatureButton = document.getElementById("clear-btn");
            const paymentList = document.getElementById("payment-list");
        
            // Error Messages
            const errors = {
                bankName: document.getElementById("bank-name-error"),
                iban: document.getElementById("iban-error"),
                authorize: document.getElementById("authorize-error"),
                signature: document.getElementById("signature-error")
            };
        
            // Open Modal
            addPaymentButton.addEventListener("click", () => {
                modal.classList.remove("hidden");
            });
        
            // Close Modal
            cancelButton.addEventListener("click", () => {
                modal.classList.add("hidden");
            });
        
            // Validate Irish IBAN Format
            function validateIBAN(iban) {
                iban = iban.toUpperCase().replace(/\s+/g, ""); // Remove spaces & ensure uppercase
                return /^IE\d{2}[A-Z]{4}\d{14}$/.test(iban) && iban.length === 22;
            }
        
            // Check if Signature is Empty
            function isSignatureEmpty() {
                const context = signaturePad.getContext("2d");
                const pixelData = context.getImageData(0, 0, signaturePad.width, signaturePad.height).data;
                return !pixelData.some((value, index) => index % 4 === 3 && value !== 0);
            }
        
            // Form Validation
            function validateForm() {
                let isValid = true;
        
                // Validate Bank Name
                if (!bankNameInput.value.trim()) {
                    errors.bankName.classList.remove("hidden");
                    isValid = false;
                } else {
                    errors.bankName.classList.add("hidden");
                }
        
                // Validate IBAN
                if (!validateIBAN(ibanInput.value.trim())) {
                    errors.iban.classList.remove("hidden");
                    isValid = false;
                } else {
                    errors.iban.classList.add("hidden");
                }
        
                // Validate Authorization Checkbox
                if (!authorizeCheckbox.checked) {
                    errors.authorize.classList.remove("hidden");
                    isValid = false;
                } else {
                    errors.authorize.classList.add("hidden");
                }
        
                // Validate Signature
                if (isSignatureEmpty()) {
                    errors.signature.classList.remove("hidden");
                    isValid = false;
                } else {
                    errors.signature.classList.add("hidden");
                }
        
                return isValid;
            }
        
            // Save Payment
            saveButton.addEventListener("click", function (event) {
                event.preventDefault();
                if (!validateForm()) return; // Show errors and stop if invalid
        
                const bankName = bankNameInput.value.trim();
                const iban = ibanInput.value.trim();
                const reference = `REF-${Math.floor(Math.random() * 9000) + 1000}`;
        
                // Create Payment Card
                const paymentCard = document.createElement("div");
                paymentCard.classList.add("border", "rounded-lg", "p-4", "mb-4", "flex", "flex-col", "md:flex-row", "items-start", "md:items-center", "justify-between", "shadow-sm", "gap-4");
        
                paymentCard.innerHTML = `
                    <div class="flex items-start md:items-center w-full">
                        <div class="w-12 h-12 bg-gray-200 flex items-center justify-center rounded-full mr-3">
                            <span class="text-gray-600 text-xl">üè¶</span>
                        </div>
                        <div class="w-full">
                            <h3 class="font-semibold text-gray-900 text-lg">${bankName}</h3>
                            <p class="text-gray-600 text-sm break-words">IBAN: <span class="font-mono">${iban}</span></p>
                            <p class="text-gray-600 text-sm">Reference: <span class="font-mono">${reference}</span></p>
                        </div>
                    </div>
                    <div class="text-right md:text-left flex flex-col md:items-end w-full">
                        <span class="bg-green-100 text-green-600 text-xs font-semibold px-3 py-1 rounded-full status">Active</span>
                        <p class="text-gray-500 text-xs mt-1">Added on ${new Date().toISOString().split('T')[0]}</p>
                        <button class="cancel-btn mt-2 bg-gray-200 text-gray-700 px-3 py-2 rounded-md hover:bg-gray-300 text-sm">Cancel</button>
                    </div>
                `;
        
                // Append Payment Card to List
                paymentList.appendChild(paymentCard);
        
                // Reset & Hide Modal
                modal.classList.add("hidden");
                bankNameInput.value = "";
                ibanInput.value = "";
                authorizeCheckbox.checked = false;
                clearSignature();
        
            });
        
            // Event Delegation for Cancel Button in Payment List
            document.addEventListener("click", function (event) {
                if (event.target.classList.contains("cancel-btn")) {
                    const paymentCard = event.target.closest(".border.rounded-lg.p-4");
                    const statusElement = paymentCard.querySelector(".status");
        
                    // Update status to "Cancelled"
                    statusElement.textContent = "Cancelled";
                    statusElement.classList.remove("bg-green-100", "text-green-600");
                    statusElement.classList.add("bg-red-100", "text-red-600");
        
                    // Remove the Cancel button smoothly
                    event.target.classList.add("opacity-0", "transition-all", "duration-300");
                    setTimeout(() => event.target.remove(), 300);
                }
            });
        
            // Remove error when user starts typing/selecting
            [bankNameInput, ibanInput].forEach(input => input.addEventListener("input", () => {
                errors[input.id].classList.add("hidden");
            }));
            authorizeCheckbox.addEventListener("change", () => errors.authorize.classList.add("hidden"));
        
            // Signature Pad
            const ctx = signaturePad.getContext("2d");
            let drawing = false;
        
            function clearSignature() {
                ctx.clearRect(0, 0, signaturePad.width, signaturePad.height);
            }
        
            signaturePad.addEventListener("mousedown", () => { drawing = true; ctx.beginPath(); });
            signaturePad.addEventListener("mouseup", () => { drawing = false; ctx.beginPath(); });
            signaturePad.addEventListener("mousemove", (event) => {
                if (!drawing) return;
                const rect = signaturePad.getBoundingClientRect();
                const x = event.clientX - rect.left;
                const y = event.clientY - rect.top;
                ctx.lineWidth = 2;
                ctx.lineCap = "round";
                ctx.strokeStyle = "black";
                ctx.lineTo(x, y);
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(x, y);
            });
        
            // Clear Signature
            clearSignatureButton.addEventListener("click", clearSignature);
        });
        </script>
        
  <script src="https://unpkg.com/flowbite@1.6.5/dist/flowbite.min.js"></script>

</body>
</html>